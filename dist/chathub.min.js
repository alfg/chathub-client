/*
 *  chathub-client - v0.0.1
 *  Chatrooms for Github Projects
 *  http://github.com/alfg/chathub-client
 *
 *  Made by Alfred Gutierrez
 *  Under MIT License
 */
function formatMessage(a){return"/code "===a.substring(0,6)?(a="<pre class='prettyprint'>"+escapeHtml(a.substring(6))+"</pre>",msg="<strong> "+user+"</strong>: "+a):""!==$("#mcode").val()?(a="<pre class='prettyprint'>"+escapeHtml(a)+"</pre>",msg="<strong> "+user+"</strong>: "+a):msg="<strong> "+user+"</strong>: "+escapeHtml(a),msg}function buildUsersOnline(a){$("#users").empty(),$.each(a,function(a,b){$("#users").append($("<li>",{html:$("<a>",{href:b.html_url,html:$("<img>",{src:b.thumbnail,width:20})})}).append(b.nickname))})}function escapeHtml(a){var b={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};return String(a).replace(/[&<>"'\/]/g,function(a){return b[a]})}var user="Guest",profile,host=window.location.host,room=window.location.pathname.substr(1)||"Lobby",GITHUB_CLIENT_ID="chathub.github.io"===host?"5272ed33c7189d449ea8":"45d29134d70365fbe5af",SOCKETIO_HOST="chathub.github.io"===host?"http://chathub-server.alfg.co":"http://alf-macbook.local:3000",OAUTH_PROXY_URL=SOCKETIO_HOST+"/proxy";$(document).ready(function(){$("[rel='tooltip']").tooltip({placement:"bottom",trigger:"hover",container:"body"}),$("#messages").height($("body").height()-300),$("#room").text(room.replace("/"," / ")),"Lobby"!==room&&$("#room").attr("href","https://github.com/"+room),emojify.setConfig({emojify_tag_type:"div",only_crawl_id:null,img_dir:"/images/emoji",ignored_tags:{SCRIPT:1,TEXTAREA:1,A:1,PRE:1,CODE:1}}),emojify.run()});var socket=io(SOCKETIO_HOST);$("form").submit(function(){var a=profile,b=$("#m").val()||$("#mcode").val(),c=formatMessage(b);return socket.emit("message",room,c,a),$("#m").val(""),$("#mcode").val(""),!1}),socket.on("connect",function(){setTimeout(function(){socket.emit("room",room,profile)},2e3),$("#messages").append($("<li>").text("You have entered the room, "+room))}),socket.on("user connected",function(a,b){$("#messages").append($("<li>").text(a)),buildUsersOnline(b)}),socket.on("user disconnected",function(a,b){$("#messages").append($("<li>").text(a)),buildUsersOnline(b)}),socket.on("message",function(a,b){var c="#",d="https://avatars0.githubusercontent.com/u/1746301";null!==b&&void 0!==b&&(c=b.html_url,d=b.thumbnail),$("#messages").append($("<li>",{html:$("<a>",{href:c,html:$("<img>",{src:d,width:20})})}).append(a)),emojify.run(),window.prettyPrint&&prettyPrint(),$("#messages").scrollTop($("#messages")[0].scrollHeight)}),hello.on("auth.login",function(a){hello.api(a.network+":/me",function(a){var b="<img src='"+a.thumbnail+"' width=20/> <strong>"+a.name+"</strong>";$("#github").html(b),$("#github").attr("data-original-title","Account"),user=a.name,profile=a})}),hello.on("auth.logout",function(){alert("Signed out");var a="<i class='fa fa-github'></i> Connect";$("#github").html(a)},function(a){alert("Signed out error:"+a.error.message)}),hello.init({github:GITHUB_CLIENT_ID},{redirect_uri:"../redirect.html",oauth_proxy:OAUTH_PROXY_URL});