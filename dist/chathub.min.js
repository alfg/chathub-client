/*
 *  chathub-client - v0.0.1
 *  Chatrooms for Github Projects
 *  http://github.com/alfg/chathub-client
 *
 *  Made by Alfred Gutierrez
 *  Under MIT License
 */
function escapeHtml(a){return String(a).replace(/[&<>"'\/]/g,function(a){return entityMap[a]})}var user="Guest",profile,host=window.location.host,room=window.location.pathname.substr(1)||"Lobby",GITHUB_CLIENT_ID="chathub.github.io"===host?"5272ed33c7189d449ea8":"45d29134d70365fbe5af",SOCKETIO_HOST="chathub.github.io"===host?"http://chathub-server.alfg.co":"http://alf-macbook.local:3000",OAUTH_PROXY_URL=SOCKETIO_HOST+"/proxy";$(document).ready(function(){$("[rel='tooltip']").tooltip({placement:"bottom",trigger:"hover",container:"body"}),$("#messages").height($("body").height()-300),$("#room").text(room.replace("/"," / ")),"Lobby"!==room&&$("#room").attr("href","https://github.com/"+room),emojify.setConfig({emojify_tag_type:"div",only_crawl_id:null,img_dir:"/images/emoji",ignored_tags:{SCRIPT:1,TEXTAREA:1,A:1,PRE:1,CODE:1}}),emojify.run()});var socket=io(SOCKETIO_HOST);$("form").submit(function(){var a,b=profile,c=$("#m").val()||$("#mcode").val();return"/code "===c.substring(0,6)?(c="<pre class='prettyprint'>"+escapeHtml(c.substring(6))+"</pre>",a="<strong> "+user+"</strong>: "+c):""!==$("#mcode").val()?(c="<pre class='prettyprint'>"+escapeHtml(c)+"</pre>",a="<strong> "+user+"</strong>: "+c):a="<strong> "+user+"</strong>: "+escapeHtml(c),socket.emit("message",room,a,b),$("#m").val(""),$("#mcode").val(""),!1}),socket.on("connect",function(){setTimeout(function(){socket.emit("room",room,profile)},2e3),$("#messages").append($("<li>").text("You have entered the room, "+room))}),socket.on("user connected",function(a,b){$("#messages").append($("<li>").text(a)),$("#users").empty(),$.each(b,function(a,b){$("#users").append($("<li>",{html:$("<a>",{href:b.html_url,html:$("<img>",{src:b.thumbnail,width:20})})}).append(b.nickname))})}),socket.on("user disconnected",function(a,b){$("#messages").append($("<li>").text(a)),$("#users").empty(),$.each(b,function(a,b){$("#users").append($("<li>",{html:$("<a>",{href:b.html_url,html:$("<img>",{src:b.thumbnail,width:20})})}).append(b.nickname))})}),socket.on("message",function(a,b){console.log("profile: "+b);var c,d;null!==b||void 0!==b?(c=b.html_url,d=b.thumbnail):(c="#",d="https://avatars0.githubusercontent.com/u/1746301"),$("#messages").append($("<li>",{html:$("<a>",{href:c,html:$("<img>",{src:d,width:20})})}).append(a)),emojify.run(),window.prettyPrint&&prettyPrint(),$("#messages").scrollTop($("#messages")[0].scrollHeight)}),hello.on("auth.login",function(a){hello.api(a.network+":/me",function(a){var b="<img src='"+a.thumbnail+"' width=20/> <strong>"+a.name+"</strong>";$("#github").html(b),$("#github").attr("data-original-title","Account"),user=a.name,profile=a,console.log(a)})}),hello.init({github:GITHUB_CLIENT_ID},{redirect_uri:"../redirect.html",oauth_proxy:OAUTH_PROXY_URL});var entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};